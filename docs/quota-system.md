# р╕гр╕░р╕Ър╕Ъ Quota - LuckSeeker Bot

## р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤

р╕гр╕░р╕Ър╕Ъ quota р╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕Ир╕│р╕Бр╕▒р╕Фр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Бр╕▓р╕гр╕Фр╕╣р╕Фр╕зр╕Зр╕Вр╕нр╕Зр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й р╣Вр╕Фр╕вр╣Бр╕Хр╣Ир╕ер╕░р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Ир╕░р╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Фр╕╣р╕Фр╕зр╕Зр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ **10 р╕Др╕гр╕▒р╣Йр╕З**

## р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щ

### р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Чр╕▒р╣Ир╕зр╣Др╕Ы

1. **р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ**: р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Гр╕лр╕бр╣Ир╕Ир╕░р╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Фр╕╣р╕Фр╕зр╕З 10 р╕Др╕гр╕▒р╣Йр╕З
2. **р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕кр╕┤р╕Чр╕Шр╕┤р╣М**: р╕Чр╕╕р╕Бр╕Др╕гр╕▒р╣Йр╕Зр╕Чр╕╡р╣Ир╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Й AI Service р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣р╕Фр╕зр╕З р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Ир╕░р╕ер╕Фр╕ер╕З 1 р╕Др╕гр╕▒р╣Йр╕З
3. **р╣Ар╕бр╕╖р╣Ир╕нр╕лр╕бр╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣М**: р╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕Ир╣Йр╕Зр╣Гр╕лр╣Йр╕Хр╕┤р╕Фр╕Хр╣Ир╕н Admin
4. **р╣Бр╕кр╕Фр╕Зр╕кр╕Цр╕▓р╕Щр╕░**: р╕лр╕ер╕▒р╕Зр╕Бр╕▓р╕гр╕Фр╕╣р╕Фр╕зр╕Зр╕Чр╕╕р╕Бр╕Др╕гр╕▒р╣Йр╕Зр╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Др╕Зр╣Ар╕лр╕ер╕╖р╕н

### р╕Др╕│р╕кр╕▒р╣Ир╕Зр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й

- `quota` р╕лр╕гр╕╖р╕н `admin:quotastatus` - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Щр╕░р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### р╕Др╕│р╕кр╕▒р╣Ир╕Зр╕кр╕│р╕лр╕гр╕▒р╕Ъ Admin

- `admin:addquota:USER_ID:AMOUNT` - р╣Ар╕Юр╕┤р╣Ир╕бр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Гр╕лр╣Йр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
  - р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З: `admin:addquota:U123456789:10` (р╣Ар╕Юр╕┤р╣Ир╕б 10 р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Гр╕лр╣Й user U123456789)

## р╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕З

### 1. Database (src/services/database.js)
- `getUserQuota(userId)` - р╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е quota р╕Вр╕нр╕Зр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
- `checkUserQuota(userId)` - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕лр╕ер╕╖р╕нр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
- `decrementUserQuota(userId)` - р╕ер╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣М 1 р╕Др╕гр╕▒р╣Йр╕З
- `addUserQuota(userId, amount)` - р╣Ар╕Юр╕┤р╣Ир╕бр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Гр╕лр╣Йр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
- `resetUserQuota(userId, amount)` - р╕гр╕╡р╣Ар╕Лр╣Зр╕Хр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й

### 2. Fortune Service (src/services/fortuneService.js)
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ quota р╕Бр╣Ир╕нр╕Щр╣Ар╕гр╕╡р╕вр╕Б AI Service
- р╕ер╕Ф quota р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╣Ар╕гр╕╡р╕вр╕Б AI Service р╕кр╕│р╣Ар╕гр╣Зр╕И
- р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕Ир╣Йр╕Зр╣Ар╕бр╕╖р╣Ир╕нр╕лр╕бр╕Ф quota

### 3. Line Controller (src/controllers/lineController.js)
- р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Др╕│р╕кр╕▒р╣Ир╕З admin р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕Юр╕┤р╣Ир╕б quota
- р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Щр╕░ quota
- р╕кр╣Ир╕З userId р╣Др╕Ыр╕вр╕▒р╕З fortuneService
- р╣Бр╕кр╕Фр╕Зр╕кр╕Цр╕▓р╕Щр╕░ quota р╕лр╕ер╕▒р╕Зр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ AI

## р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е Quota

```json
{
  "userId": {
    "remainingQueries": 10,
    "totalQueries": 10,
    "usedQueries": 0,
    "lastUpdated": "2024-01-01T00:00:00.000Z",
    "resetDate": null
  }
}
```

## р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣М
```
User: quota
Bot: ЁЯУК р╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Вр╕нр╕Зр╕Др╕╕р╕У
ЁЯФв р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Др╕Зр╣Ар╕лр╕ер╕╖р╕н: 8 р╕Др╕гр╕▒р╣Йр╕З
ЁЯУИ р╣Гр╕Кр╣Йр╣Др╕Ыр╣Бр╕ер╣Йр╕з: 2 р╕Др╕гр╕▒р╣Йр╕З
ЁЯТп р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф: 10 р╕Др╕гр╕▒р╣Йр╕З
тЬЕ р╕вр╕▒р╕Зр╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
```

### р╕лр╕ер╕▒р╕Зр╕Бр╕▓р╕гр╕Фр╕╣р╕Фр╕зр╕З (р╣Бр╕кр╕Фр╕Зр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤)
```
Bot: [р╕Ьр╕ер╕Бр╕▓р╕гр╕Фр╕╣р╕Фр╕зр╕З...]

ЁЯУК **р╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ**
ЁЯФв р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Др╕Зр╣Ар╕лр╕ер╕╖р╕н: 7 р╕Др╕гр╕▒р╣Йр╕З
ЁЯУИ р╣Гр╕Кр╣Йр╣Др╕Ыр╣Бр╕ер╣Йр╕з: 3 р╕Др╕гр╕▒р╣Йр╕З
ЁЯТп р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф: 10 р╕Др╕гр╕▒р╣Йр╕З
```

### р╣Ар╕бр╕╖р╣Ир╕нр╕лр╕бр╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣М
```
Bot: ЁЯЪл р╕лр╕бр╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
р╕Вр╕нр╕нр╕ар╕▒р╕вр╕Др╣Ир╕░ р╕Др╕╕р╕Ур╣Др╕Фр╣Йр╣Гр╕Кр╣Йр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Фр╕╣р╕Фр╕зр╕Зр╕Др╕гр╕Ъ 10 р╕Др╕гр╕▒р╣Йр╕Зр╣Бр╕ер╣Йр╕зр╣Гр╕Щр╕гр╕нр╕Ър╕Щр╕╡р╣Й
ЁЯУЮ р╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕┤р╕Фр╕Хр╣Ир╕н Admin р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣р╕Фр╕зр╕Зр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б
```

### Admin р╣Ар╕Юр╕┤р╣Ир╕бр╕кр╕┤р╕Чр╕Шр╕┤р╣М
```
Admin: admin:addquota:U123456789:10
Bot: тЬЕ р╣Ар╕Юр╕┤р╣Ир╕б quota р╕кр╕│р╣Ар╕гр╣Зр╕И!
User ID: U123456789
р╣Ар╕Юр╕┤р╣Ир╕б: 10 р╕Др╕гр╕▒р╣Йр╕З
р╕Др╕Зр╣Ар╕лр╕ер╕╖р╕н: 10 р╕Др╕гр╕▒р╣Йр╕З
р╕гр╕зр╕бр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф: 20 р╕Др╕гр╕▒р╣Йр╕З
```

## р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Бр╕ер╕░р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

р╕гр╕░р╕Ър╕Ъ quota р╕Ир╕░р╣Ар╕гр╕┤р╣Ир╕бр╕Чр╕│р╕Зр╕▓р╕Щр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕нр╕▒р╕Юр╣Ар╕Фр╕Ч р╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б

р╕Вр╣Йр╕нр╕бр╕╣р╕е quota р╕Ир╕░р╕Цр╕╣р╕Бр╣Ар╕Бр╣Зр╕Ър╣Гр╕Щр╣Др╕Яр╕ер╣М `data/userQuota.json`

## р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤р╣Гр╕лр╕бр╣И

### р╣Бр╕кр╕Фр╕Зр╕кр╕Цр╕▓р╕Щр╕░р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
- р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕Фр╕╣р╕Фр╕зр╕Зр╕Чр╕╕р╕Бр╕Др╕гр╕▒р╣Йр╕З р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕кр╕Цр╕▓р╕Щр╕░ quota р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
- р╕Кр╣Ир╕зр╕вр╣Гр╕лр╣Йр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Чр╕гр╕▓р╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Др╕Зр╣Ар╕лр╕ер╕╖р╕нр╣Бр╕Ър╕Ъ real-time
- р╣Др╕бр╣Ир╕Щр╕▒р╕Ъ quota р╕лр╕▓р╕Бр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕бр╕▓р╕Ир╕▓р╕Б cache

### р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Лр╣Йр╕│
- р╕гр╕░р╕Ър╕Ър╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕Бр╕▓р╕г request р╕Лр╣Йр╕│р╣Ар╕Юр╕╖р╣Ир╕нр╣Др╕бр╣Ир╣Гр╕лр╣Йр╣Ар╕кр╕╡р╕в quota р╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ
- Loading animation р╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕бр╣Ар╕Юр╕╖р╣Ир╕н user experience р╕Чр╕╡р╣Ир╕Фр╕╡